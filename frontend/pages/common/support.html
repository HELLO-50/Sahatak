<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title-head">Support Page - Sahatak</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><path fill='%230d47a1' d='m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523.942-.661 2.27.067 3.71L8 15.5l6.533-8.737c.728-1.44.59-2.768.067-3.71C13.486.878 10.4.28 8.717 2.01L8 2.748z'/></svg>">
    
    <!-- Bootstrap 5 CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    
    <!-- Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <!-- Arabic Font - Noto Sans Arabic -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="../../assets/css/main.css">
    <!-- Dashboard CSS -->
    <link rel="stylesheet" href="../../assets/css/components/dashboard.css">
    <!-- Appointments CSS -->
    <link rel="stylesheet" href="../../assets/css/components/appointments.css">
    <!-- Video Consultation Dashboard CSS -->
    <link rel="stylesheet" href="../../assets/css/components/video-consultation-dashboard.css">
</head>
<body data-protect="patient">
    <div class="dashboard-container">
        <div class="container-fluid" style="padding-bottom: 120px;">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div class="row align-items-center">
                    <!-- Profile Section - Left (Right in RTL) -->
                    <div class="col-lg-4">
                        <div class="profile-section">
                            <div class="user-avatar">
                                <i class="bi bi-person-fill"></i>
                            </div>
                            <div class="user-details">
                                <h5 class="mb-1" id="user-name">Loading...</h5>
                            </div>
                            <!-- Vertical Action Buttons -->
                            <div class="action-buttons">
                                <button class="btn btn-action" onclick="goBackToDashboard()" title="Back to Dashboard">
                                    <i class="bi bi-arrow-left"></i>
                                    <span id="btn-back">Back to Dashboard</span>
                                </button>
                                <button class="btn btn-action btn-logout" onclick="AuthGuard.logout()" title="Logout">
                                    <i class="bi bi-box-arrow-right"></i>
                                    <span id="btn-logout">Logout</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Page Title - Center -->
                    <div class="col-lg-4 text-center">
                        <h1 class="dashboard-title" id="page-title">Support Sahatak</h1>
                        <p class="dashboard-subtitle" id="page-subtitle">Technical Support</p>
                    </div>
                    
                    <!-- Controls - Right (Left in RTL) -->
                    <div class="col-lg-4 text-end">
                        <div class="dashboard-controls">
                            <button class="btn btn-medical btn-sm me-2" onclick="bookNewAppointment()">
                                <i class="bi bi-plus me-1"></i>
                                <span id="btn-new-appointment">Add Comments</span>
                            </button>
                            <button class="btn btn-outline-medical btn-sm" onclick="showLanguageSelector()">
                                <i class="bi bi-globe me-1"></i>
                                <span id="current-lang">English</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Support Content -->
            <!-- Support & Supervisor Messaging -->
            <section id="support-section" class="mt-4">
                <div class="row gy-4">
                    <!-- Report a Problem Card -->
                    <div class="col-lg-6">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title"><i class="bi bi-bug-fill me-2"></i>Report a Problem</h5>
                                <p class="text-muted small">Tell us about any issues you face while using the app. Our support team will review and respond.</p>

                                <div id="report-alert" class="alert d-none" role="alert"></div>

                                <form id="report-form" novalidate>
                                    <div class="mb-3">
                                        <label for="problem-subject" class="form-label">Subject</label>
                                        <input type="text" id="problem-subject" name="subject" class="form-control" required maxlength="120" placeholder="Short summary of the issue">
                                    </div>

                                    <div class="mb-3">
                                        <label for="problem-description" class="form-label">Description</label>
                                        <textarea id="problem-description" name="description" class="form-control" rows="6" required placeholder="Describe the steps to reproduce the issue, expected vs actual behavior, and any error messages."></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label for="problem-screenshot" class="form-label">Attachment (optional)</label>
                                        <input id="problem-screenshot" name="attachment" type="file" class="form-control" accept="image/*,.log,.txt,.pdf">
                                        <div class="form-text">Attach screenshots, logs, or a short recording (max 10MB).</div>
                                    </div>

                                    <div class="d-flex justify-content-end">
                                        <button type="submit" class="btn btn-medical">
                                            <i class="bi bi-send-fill me-1"></i> Send Report
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Message Supervisors Card -->
                    <div class="col-lg-6">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title"><i class="bi bi-envelope-fill me-2"></i>Message Supervisors</h5>
                                <p class="text-muted small">Send a direct message to program supervisors for feedback, escalations or private concerns.</p>

                                <div id="supervisor-alert" class="alert d-none" role="alert"></div>

                                <form id="supervisor-form" novalidate>
                                    <div class="mb-3">
                                        <label for="supervisor-to" class="form-label">To (Supervisor)</label>
                                        <select id="supervisor-to" name="to" class="form-select" required>
                                            <option value="">Select a recipient</option>
                                            <option value="lead">Lead Supervisor</option>
                                            <option value="ops">Operations Manager</option>
                                            <option value="tech">Technical Supervisor</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label for="supervisor-subject" class="form-label">Subject</label>
                                        <input id="supervisor-subject" name="subject" type="text" class="form-control" required maxlength="120" placeholder="Brief subject">
                                    </div>

                                    <div class="mb-3">
                                        <label for="supervisor-message" class="form-label">Message</label>
                                        <textarea id="supervisor-message" name="message" class="form-control" rows="6" required placeholder="Write your message to the supervisors..."></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label for="supervisor-phone" class="form-label">Contact (optional)</label>
                                        <input id="supervisor-phone" name="contact" type="tel" class="form-control" placeholder="Phone or email for a reply">
                                    </div>

                                    <div class="d-flex justify-content-end">
                                        <button type="submit" class="btn btn-outline-medical">
                                            <i class="bi bi-chat-dots me-1"></i> Send Message
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Client-side handlers (no external submission) -->
            <script>
                (function () {
                    function showAlert(container, type, text) {
                        container.className = 'alert alert-' + type;
                        container.textContent = text;
                        container.classList.remove('d-none');
                        setTimeout(() => container.classList.add('d-none'), 5000);
                    }

                    // Report form
                    const reportForm = document.getElementById('report-form');
                    const reportAlert = document.getElementById('report-alert');
                    reportForm.addEventListener('submit', function (e) {
                        e.preventDefault();
                        if (!reportForm.checkValidity()) {
                            showAlert(reportAlert, 'warning', 'Please complete the required fields.');
                            return;
                        }
                        // Collect data (replace with real submission)
                        const data = new FormData(reportForm);
                        // TODO: send 'data' via fetch to your backend endpoint
                        showAlert(reportAlert, 'success', 'Problem report sent. Our support team will contact you shortly.');
                        reportForm.reset();
                    });

                    // Supervisor form
                    const supervisorForm = document.getElementById('supervisor-form');
                    const supervisorAlert = document.getElementById('supervisor-alert');
                    supervisorForm.addEventListener('submit', function (e) {
                        e.preventDefault();
                        if (!supervisorForm.checkValidity()) {
                            showAlert(supervisorAlert, 'warning', 'Please complete the required fields.');
                            return;
                        }
                        const data = new FormData(supervisorForm);
                        // TODO: send 'data' via fetch to your backend endpoint
                        showAlert(supervisorAlert, 'success', 'Your message was sent to the supervisors.');
                        supervisorForm.reset();
                    });
                })();
            </script>